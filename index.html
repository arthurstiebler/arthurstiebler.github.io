<!DOCTYPE html>
<html lang="pt-BR">
	<head>
		<meta charset="UTF-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<title>Identificação de equipamento</title>
		<style>
			* {
			margin: 0;
			padding: 0;
			box-sizing: border-box;
			font-family: Arial, sans-serif;
			}
			body {
			display: flex;
			flex-direction: column;
			align-items: center;
			background: #00748b;
			color: #ffffff;
			height: 100vh;
			overflow: hidden;
			}
			.header {
			width: 100%;
			background: rgb(230, 230, 230);
			padding: 1em 0;
			display: flex;
			justify-content: center;
			align-items: center;
			position: fixed;
			top: 0;
			z-index: 1000;
			}
			.header a {
			display: flex;
			justify-content: center;
			align-items: center;
			}
			.header img {
			height: 50px;
			}
			.main-content {
			margin-top: 80px; /* espaço para a faixa fixa */
			display: flex;
			justify-content: center;
			align-items: center;
			flex-grow: 1;
			width: 100%;
			}
			.central-container {
			background: #ffffff;
			color: #00748b;
			padding: 3em;
			border-radius: 10px;
			box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
			text-align: center;
			}
			.central-container h1 {
			margin-bottom: 1em;
			font-size: 2em;
			}
			.central-container p {
			margin-bottom: 1.5em;
			font-size: 1.2em;
			}
			button {
			background: #ee6f3c;
			color: #ffffff;
			border: none;
			padding: 0.8em 1.5em;
			border-radius: 5px;
			cursor: pointer;
			font-size: 1em;
			transition: background 0.3s;
			}
			button:hover {
			background: #c3562d;
			}
			@media (max-width: 600px) {
			.central-container {
			padding: 2em;
			}
			.central-container h1 {
			font-size: 1.5em;
			}
			.central-container p {
			font-size: 1em;
			}
			button {
			padding: 0.6em 1.2em;
			font-size: 0.9em;
			}
			}
		</style>
	</head>
	<body>
		<div class="header">
			<a href="https://www.multmotores.com.br/" target="_blank">
			<img src="https://www.multmotores.com.br/imagens/logo-multmotores.png" alt="Logo MultMotores">
			</a>
		</div>
		<div class="main-content">
			<div class="central-container">
				<h1>Escanei abaixo</h1>
				<button id="actionButton" type="button" onclick="init()">Ligue a câmera</button>
			</div>
			<div class="central-container" id="webcam-container">
			</div>
			<div class="central-container" id="label-container">
			</div>
		</div>
		<script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@latest/dist/tf.min.js"></script>
		<script src="https://cdn.jsdelivr.net/npm/@teachablemachine/image@latest/dist/teachablemachine-image.min.js"></script>
		<script type="text/javascript">
			// More API functions here:
			// https://github.com/googlecreativelab/teachablemachine-community/tree/master/libraries/image
			
			// the link to your model provided by Teachable Machine export panel
			const URL = "https://teachablemachine.withgoogle.com/models/xU6eb8w7O/";
			
			let model, webcam, labelContainer, maxPredictions;
			
			// Load the image model and setup the webcam
			async function init() {
			    const modelURL = URL + "model.json";
			    const metadataURL = URL + "metadata.json";
			
			    // load the model and metadata
			    // Refer to tmImage.loadFromFiles() in the API to support files from a file picker
			    // or files from your local hard drive
			    // Note: the pose library adds "tmImage" object to your window (window.tmImage)
			    model = await tmImage.load(modelURL, metadataURL);
			    maxPredictions = model.getTotalClasses();
			
			    // Convenience function to setup a webcam
			    const flip = true; // whether to flip the webcam
			    webcam = new tmImage.Webcam(200, 200, flip); // width, height, flip
			    await webcam.setup(); // request access to the webcam
			    await webcam.play();
			    window.requestAnimationFrame(loop);
			
			    // append elements to the DOM
			    document.getElementById("webcam-container").appendChild(webcam.canvas);
			    labelContainer = document.getElementById("label-container");
			    for (let i = 0; i < maxPredictions; i++) { // and class labels
			        labelContainer.appendChild(document.createElement("div"));
			    }
			}
			
			async function loop() {
			    webcam.update(); // update the webcam frame
			    await predict();
			    window.requestAnimationFrame(loop);
			}
			
			// run the webcam image through the image model
			async function predict() {
			    // predict can take in an image, video or canvas html element
			    const prediction = await model.predict(webcam.canvas);
			    for (let i = 0; i < maxPredictions; i++) {
			        const classPrediction =
			            prediction[i].className + ": " + prediction[i].probability.toFixed(2);
			        labelContainer.childNodes[i].innerHTML = classPrediction;
			    }
			}
		</script>
	</body>
</html>